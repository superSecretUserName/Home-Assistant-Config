background: var(--background-image)
button_card_templates: !include button_card_templates.yaml  
title: Loft
views:
  - path: default_view
    title: Home
    panel: false
    icon: 'mdi:home'
    badges:
      - entity: person.jeffrey_glusman
      - entity: person.tiffany_conaway
      - entity: sensor.temperature_living_room
    cards:
      - type: vertical-stack
        cards:
          - type: entities
            style: |
              ha-card {
                border-radius: 30px;
                background: rgba(0,0,0,.3);
                box-shadow: none;
                }
            #################################################################
            #----------------------------------------------------------------
            ## Toggle Nav
            #----------------------------------------------------------------
            #################################################################
            entities:
              - type: 'custom:paper-buttons-row'
                buttons:
                  #################################################################
                  ## Entryway Button
                  #################################################################          
                  - entity: input_select.lighttoggle
                    name: false
                    icon: 'hass:coat-rack'
                    state_styles:
                      Entrway:
                      template: nav_button
                    template: nav_styles
                    tap_action:
                      action: call-service
                      service: input_select.select_option
                      service_data:
                        entity_id: input_select.lighttoggle
                        option: Entryway
                  #################################################################
                  ## Office Button
                  #################################################################                     
                  - entity: input_select.lighttoggle
                    name: false
                    icon: 'hass:desk'
                    state_styles:
                      Office:
                      template: nav_button
                    template: nav_styles
                    tap_action:
                      action: call-service
                      service: input_select.select_option
                      service_data:
                        entity_id: input_select.lighttoggle
                        option: Office
                  #################################################################
                  ## Living Room Button
                  #################################################################                     
                  - entity: input_select.lighttoggle
                    name: false
                    icon: 'hass:sofa'
                    state_styles:
                      Living Room:
                      template: nav_button
                    template: nav_styles
                    tap_action:
                      action: call-service
                      service: input_select.select_option
                      service_data:
                        entity_id: input_select.lighttoggle
                        option: Living Room
                  #################################################################
                  ## Kitchen Button
                  #################################################################
                  - entity: input_select.lighttoggle
                    name: false
                    icon: 'hass:fridge'
                    state_styles:
                      Kitchen:
                      template: nav_button
                    template: nav_styles
                    tap_action:
                      action: call-service
                      service: input_select.select_option
                      service_data:
                        entity_id: input_select.lighttoggle
                        option: Kitchen
          #################################################################
          #----------------------------------------------------------------
          ## Expanded
          #----------------------------------------------------------------
          #################################################################                
          - type: 'custom:state-switch'
            entity: input_select.lighttoggle
            default: Entryway
            transition: flip
            states:
              #################################################################
              ## Entrway Controls
              #################################################################
              Entryway:
                type: 'custom:mod-card'
                style: |
                  ha-card {
                    background: rgba(0,0,0,.3);
                    padding: 10px;
                    border-radius: 35px;
                    margin-top: none;
                    }
                card:
                  type: grid
                  columns: 3
                  cards:
                    #----------------------------------------------------------------
                    ## Hallway Marquee  
                    #----------------------------------------------------------------         
                    - type: 'custom:button-card'
                      entity: light.hallway_marquee
                      custom_fields:
                          icon_marquee: >
                            <svg viewBox="0 0 50 50">
                            <path fill="#fcd40a" d="M20 22H18V17H20M6 22H4V17H6M23 4V13A2 2 0 0 1 21 15H3A2 2 0 0 1 1 13V4A2 2 0 0 1 3 2H21A2 2 0 0 1 23 4M21 4H3V13H21M20 6H15V8H20M18 9H15V11H18M14 11H4L6.73 7.36L8.73 10.09L9.46 9.55L8.2 7.82L9.91 5.55Z"/>
                            <path class="${state}" fill="var(--button-card-light-color-no-temperature)" d="M20 22H18V17H20M6 22H4V17H6M23 4V13A2 2 0 0 1 21 15H3A2 2 0 0 1 1 13V4A2 2 0 0 1 3 2H21A2 2 0 0 1 23 4M21 4H3V13H21M20 6H15V8H20M18 9H15V11H18M14 11H4L6.73 7.36L8.73 10.09L9.46 9.55L8.2 7.82L9.91 5.55Z"/> </svg>`
                      styles:
                        custom_fields:
                          icon_marquee:
                            [top: 11%, left: 6%, width: 5.25em, position: absolute]                  
                      template: light     
                      hold_action:
                        action: none
                    #----------------------------------------------------------------
                    ## Hallway Runner  
                    #----------------------------------------------------------------
                    - type: 'custom:button-card'
                      entity: light.hallway_runner
                      name: Runner         
                      custom_fields:
                          icon_led: &icon_led >
                            [[[ const state = entity.state === 'on' ? 'animate' : null;
                            return `<svg viewBox="0 0 50 50"><style>@keyframes animate{0%{transform: scale(0.85);}20%{transform: scale(1.1);}40%{transform: scale(0.95);}60%{transform: scale(1.03);}80%{transform: scale(0.97);}100%{transform: scale(1);}}.animate{animation: animate 0.8s; transform-origin: center;}</style>
                            <path fill="#9da0a2" d="M2.95 3L2 6.91L19.34 11.25L20.29 7.34L2.95 3M6.09 6.89L4.16 6.41L4.64 4.46L6.57 4.94L6.09 6.89M9.94 7.86L8 7.38L8.5 5.42L10.42 5.91L9.94 7.86M13.8 8.82L11.87 8.34L12.35 6.39L14.27 6.87L13.8 8.82M17.65 9.79L15.72 9.31L16.2 7.35L18.13 7.84L17.65 9.79M4.66 12.75L3.71 16.66L21.05 21L22 17.1L4.66 12.75M7.8 16.65L5.88 16.16L6.35 14.21L8.28 14.69L7.8 16.65M11.65 17.61L9.73 17.13L10.2 15.18L12.13 15.66L11.65 17.61M15.5 18.58L13.58 18.09L14.06 16.14L16 16.62L15.5 18.58M19.36 19.54L17.43 19.06L17.91 17.11L19.84 17.59L19.36 19.54M6.25 12.11L11 10.2L17.75 11.89L13 13.8L6.25 12.11Z"/>
                            <path class="${state}" fill="var(--button-card-light-color-no-temperature)" d="M2.95 3L2 6.91L19.34 11.25L20.29 7.34L2.95 3M6.09 6.89L4.16 6.41L4.64 4.46L6.57 4.94L6.09 6.89M9.94 7.86L8 7.38L8.5 5.42L10.42 5.91L9.94 7.86M13.8 8.82L11.87 8.34L12.35 6.39L14.27 6.87L13.8 8.82M17.65 9.79L15.72 9.31L16.2 7.35L18.13 7.84L17.65 9.79M4.66 12.75L3.71 16.66L21.05 21L22 17.1L4.66 12.75M7.8 16.65L5.88 16.16L6.35 14.21L8.28 14.69L7.8 16.65M11.65 17.61L9.73 17.13L10.2 15.18L12.13 15.66L11.65 17.61M15.5 18.58L13.58 18.09L14.06 16.14L16 16.62L15.5 18.58M19.36 19.54L17.43 19.06L17.91 17.11L19.84 17.59L19.36 19.54M6.25 12.11L11 10.2L17.75 11.89L13 13.8L6.25 12.11Z"/> </svg>`;]]]
                      styles: &icon_led_styles
                        custom_fields:
                          icon_led:
                            [top: 11%, left: 5%, width: 5.25em, position: absolute]                          
                      template: light-color     
                    #----------------------------------------------------------------
                    ## Potter Lamp  
                    #----------------------------------------------------------------
                    - type: 'custom:button-card'
                      entity: light.potter_lamp
                      name: Lamp   
                      custom_fields:
                          icon_lamp: &icon_lamp >
                            [[[ const state = entity.state === 'on' ? 'animate' : null;
                            return `<svg viewBox="0 0 50 50"><style>@keyframes animate{0%{transform: scale(0.85);}20%{transform: scale(1.1);}40%{transform: scale(0.95);}60%{transform: scale(1.03);}80%{transform: scale(0.97);}100%{transform: scale(1);}}.animate{animation: animate 0.8s; transform-origin: center;}</style>
                            <path fill="#9da0a2" d="M26.4 25.6c.6-.3 1.1-.7 1.1-1.3L25 17.9l-2.5 6.4c0 .7.6 1.1 1.1 1.3v20.8h-5.5v2.7h13.7v-2.7h-5.5V25.6z"/>
                            <path class="${state}" fill="var(--button-card-light-color-no-temperature)" d="M24.6.9l-9.4.5c-.6.1-1.9 0-2.5 2.1s-2.4 9.1-4 16.9c-.2.7-.5 2-.5 2.3s-.4 1.6.9 1.6c.8.1 7.4.3 15.9.3 8.6 0 15.1-.3 15.9-.3 1.3-.1.9-1.3.9-1.6s-.3-1.6-.5-2.3c-1.6-7.8-3.4-14.8-4-16.9s-1.9-2-2.5-2.1c-1.6-.2-6.9-.4-9.4-.5"/> </svg>`;]]]
                      styles: &icon_lamp_styles
                        custom_fields:
                          icon_lamp:
                            [top: 11%, left: 5%, width: 2.85em, position: absolute]                                                 
                      template: light-color   
                    #----------------------------------------------------------------
                    ## Stair Light  
                    #----------------------------------------------------------------
                    - type: 'custom:button-card'
                      entity: light.stair
                      name: Lamp  
                      custom_fields:
                          icon_spot: &icon_spot >
                            [[[ const state = entity.state === 'on' ? 'animate_on' : 'animate_off';
                            return `<svg viewBox="0 0 50 50"><style>@keyframes animate_on{0%{transform: rotateZ(0deg); animation-timing-function: cubic-bezier(0.7, 0, 0.84, 0);}70%{transform: rotateZ(-15deg); animation-timing-function: cubic-bezier(0.16, 1, 0.3, 1);}75%{transform: rotateZ(-15deg); animation-timing-function: cubic-bezier(0.16, 1, 0.3, 1);}88%{transform: rotateZ(-11deg);}100%{transform: rotateZ(-15deg);}}.animate_on{animation: animate_on 0.7s; transform-origin: 40% 20%; animation-fill-mode: forwards; animation-delay: -0.1s;}@keyframes animate_off{0%{transform: rotateZ(-15deg); animation-timing-function: cubic-bezier(0.7, 0, 0.84, 0);}70%{transform: rotateZ(0deg); animation-timing-function: cubic-bezier(0.16, 1, 0.3, 1);}75%{transform: rotateZ(0deg); animation-timing-function: cubic-bezier(0.16, 1, 0.3, 1);}88%{transform: rotateZ(-4deg);}100%{transform: rotateZ(0deg);}}.animate_off{animation: animate_off 0.7s; transform-origin: 40% 20%; animation-fill-mode: forwards;}</style>
                            <path style="clip-path: url(#mask);" fill="#9da0a2" d="M40.5.8H17.1c-.1 0-.1 0-.1.1A3.12 3.12 0 0 0 20.1 4h6.1c.1 0 .1 0 .1.1v7.4L18 19.1l3.6 3.5 9.1-8.6c.4-.4.6-1 .7-1.6V4c0-.1 0-.1.1-.1h6c1.7.1 3.1-1.3 3-3.1z"/><defs><clipPath id="mask"><path class="${state}" d="M0 9.1h24l8.3 8.8H50V-9H0z"/></clipPath></defs><path class="${state}" fill="var(--button-card-light-color-no-temperature)" d="M25.5 46.4s1.4.5 10.4-8.2c.5-.4 6.3-6.3 5.8-7.1-.7-.8-18.6-19.5-18.6-19.5s-.6-.9-8.6 6.4c-.6.5-8.7 8-7.7 9.1l18.7 19.3z"/></svg>`; ]]]
                      styles: &icon_spot_styles
                        custom_fields:
                          icon_spot:
                            [top: 11%, left: 5%, width: 2.85em, position: absolute]                          
                      template: light                
                    #----------------------------------------------------------------
                    ## Front Door Sensor  
                    #----------------------------------------------------------------               
                    - type: 'custom:button-card'
                      entity: binary_sensor.front_door
                      template: test
              #################################################################
              ## Office Controls
              #################################################################
              Office:
                type: 'custom:mod-card'
                style: |
                  ha-card {
                    background: rgba(0,0,0,.3);
                    padding: 10px;
                    border-radius: 35px;
                    margin-top: none;
                    }
                card:
                  type: grid
                  columns: 3
                  cards:
                    #----------------------------------------------------------------
                    ## Office Overhead Lights  
                    #----------------------------------------------------------------
                    - type: 'custom:button-card'
                      entity: light.overhead
                      name: Ceiling
                      custom_fields:
                          icon_overhead: &icon_overhead >
                            [[[ const state = entity.state === 'on' ? 'animate' : null;
                            return `<svg viewBox="0 0 50 50"><style>@keyframes animate{0%{transform: scale(0.85);}20%{transform: scale(1.1);}40%{transform: scale(0.95);}60%{transform: scale(1.03);}80%{transform: scale(0.97);}100%{transform: scale(1);}}.animate{animation: animate 0.8s; transform-origin: center;}</style>
                            <path fill="#9da0a2" d="M21 10C21 14.97 16.97 19 12 19C7.03 19 3 14.97 3 10V9.03C3 8.76 3.11 8.5 3.3 8.3C3.5 8.11 3.76 8 4.03 8H20C20.25 8 20.5 8.11 20.7 8.3C20.89 8.5 21 8.75 21 9V10M5 10C5 13.86 8.14 17 12 17C15.86 17 19 13.86 19 10H5M20 6V7H4V6C4 5.73 4.1 5.5 4.29 5.29C4.5 5.1 4.73 5 5 5H10V3H14V5H19C19.25 5 19.5 5.11 19.7 5.3C19.89 5.5 20 5.75 20 6Z"/>
                            <path class="${state}" fill="var(--button-card-light-color-no-temperature)" d="M21 10C21 14.97 16.97 19 12 19C7.03 19 3 14.97 3 10V9.03C3 8.76 3.11 8.5 3.3 8.3C3.5 8.11 3.76 8 4.03 8H20C20.25 8 20.5 8.11 20.7 8.3C20.89 8.5 21 8.75 21 9V10M5 10C5 13.86 8.14 17 12 17C15.86 17 19 13.86 19 10H5M20 6V7H4V6C4 5.73 4.1 5.5 4.29 5.29C4.5 5.1 4.73 5 5 5H10V3H14V5H19C19.25 5 19.5 5.11 19.7 5.3C19.89 5.5 20 5.75 20 6Z"/> </svg>`;]]]
                      styles: &icon_overhead_styles
                        custom_fields:
                          icon_overhead:
                            [top: 11%, left: 5%, width: 5.25em, position: absolute]                    
                      template: light   
                    #----------------------------------------------------------------
                    ## Office Desk Light  
                    #----------------------------------------------------------------
                    - type: 'custom:button-card'
                      entity: light.overhead_desk
                      name: Desk
                      custom_fields:
                        icon_overhead: *icon_overhead
                      styles: *icon_overhead_styles                  
                      template: light
                    #----------------------------------------------------------------
                    ## Office Bed Light  
                    #----------------------------------------------------------------
                    - type: 'custom:button-card'
                      entity: light.overhead_bed
                      name: Bed
                      custom_fields:
                        icon_overhead: *icon_overhead
                      styles: *icon_overhead_styles                   
                      template: light
                    #----------------------------------------------------------------
                    ## Printer
                    #----------------------------------------------------------------
                    - type: 'custom:button-card'
                      entity: switch.major_laser_printer
                      name: Major Laser
                      template: test
              #################################################################
              ## Living Room Controls
              #################################################################
              Living Room:
                type: 'custom:mod-card'
                style: |
                  ha-card {
                    background: rgba(0,0,0,.3);
                    padding: 10px;
                    border-radius: 35px;
                    margin-top: none;
                    }
                card:
                  type: grid
                  columns: 3
                  cards:
                    #----------------------------------------------------------------
                    ## Track Light
                    #----------------------------------------------------------------            
                    - type: 'custom:button-card'
                      entity: light.track
                      name: Track
                      custom_fields:
                        icon_spot: *icon_spot
                      styles: *icon_spot_styles                                     
                      template: light-color
                    #----------------------------------------------------------------
                    ## Garden Light
                    #----------------------------------------------------------------                
                    - type: 'custom:button-card'
                      entity: light.garden
                      name: Garden
                      custom_fields:
                          icon_garden: >
                            [[[ const state = entity.state === 'on' ? 'animate' : null;
                            return `<svg viewBox="0 0 50 50"><style>@keyframes animate{0%{transform: scale(0.85);}20%{transform: scale(1.1);}40%{transform: scale(0.95);}60%{transform: scale(1.03);}80%{transform: scale(0.97);}100%{transform: scale(1);}}.animate{animation: animate 0.8s; transform-origin: center;}</style>
                            <path fill="#9da0a2" d="M22.56 11.39C22.36 10.59 21.82 9.85 21.05 9.44L20.63 7.74C21.11 7.58 21.57 7.41 22 7.23V5C20 6.07 16.53 7.03 12 7.03S4 6.07 2 5V7.23C2.43 7.41 2.89 7.58 3.37 7.74L2.95 9.44C2.18 9.85 1.64 10.59 1.44 11.39C.905 13.57 .385 17.31 2.92 17.93C4 18.2 6 17.89 7.27 12.82C7.46 12 7.33 11.12 6.84 10.39L7.26 8.67C8.14 8.81 9.05 8.9 10 8.96V10.74C9.35 11.33 9 12.17 9 13C9 15.24 9.39 19 12 19C13.12 19 15 18.22 15 13C15 12.17 14.65 11.33 14 10.74V8.96C14.95 8.9 15.86 8.81 16.74 8.67L17.16 10.39C16.67 11.12 16.54 12 16.73 12.82C18 17.89 20 18.2 21.08 17.93C23.61 17.31 23.09 13.57 22.56 11.39M5.81 12.47C5.81 12.47 4.74 16.84 3.28 16.5C1.82 16.12 2.9 11.75 2.9 11.75S3.26 10.29 4.71 10.65 5.81 12.47 5.81 12.47M12 17.5C10.5 17.5 10.5 13 10.5 13S10.5 11.5 12 11.5 13.5 13 13.5 13 13.5 17.5 12 17.5M20.72 16.5C19.27 16.84 18.19 12.47 18.19 12.47S17.83 11 19.29 10.65 21.1 11.75 21.1 11.75 22.18 16.12 20.72 16.5Z"/>
                            <path class="${state}" fill="var(--button-card-light-color-no-temperature)" d="M22.56 11.39C22.36 10.59 21.82 9.85 21.05 9.44L20.63 7.74C21.11 7.58 21.57 7.41 22 7.23V5C20 6.07 16.53 7.03 12 7.03S4 6.07 2 5V7.23C2.43 7.41 2.89 7.58 3.37 7.74L2.95 9.44C2.18 9.85 1.64 10.59 1.44 11.39C.905 13.57 .385 17.31 2.92 17.93C4 18.2 6 17.89 7.27 12.82C7.46 12 7.33 11.12 6.84 10.39L7.26 8.67C8.14 8.81 9.05 8.9 10 8.96V10.74C9.35 11.33 9 12.17 9 13C9 15.24 9.39 19 12 19C13.12 19 15 18.22 15 13C15 12.17 14.65 11.33 14 10.74V8.96C14.95 8.9 15.86 8.81 16.74 8.67L17.16 10.39C16.67 11.12 16.54 12 16.73 12.82C18 17.89 20 18.2 21.08 17.93C23.61 17.31 23.09 13.57 22.56 11.39M5.81 12.47C5.81 12.47 4.74 16.84 3.28 16.5C1.82 16.12 2.9 11.75 2.9 11.75S3.26 10.29 4.71 10.65 5.81 12.47 5.81 12.47M12 17.5C10.5 17.5 10.5 13 10.5 13S10.5 11.5 12 11.5 13.5 13 13.5 13 13.5 17.5 12 17.5M20.72 16.5C19.27 16.84 18.19 12.47 18.19 12.47S17.83 11 19.29 10.65 21.1 11.75 21.1 11.75 22.18 16.12 20.72 16.5Z"/> </svg>`;]]]
                      styles:
                        custom_fields:
                          icon_garden:
                            [top: 11%, left: 5%, width: 5.25em, position: absolute] 
                      template: light  
                      hold_action:
                        action: none                         
                    #----------------------------------------------------------------
                    ## Yumi Lamp
                    #----------------------------------------------------------------                
                    - type: 'custom:button-card'
                      entity: light.yumi_lamp
                      name: Lamp
                      custom_fields:
                        icon_lamp: *icon_lamp
                      styles: *icon_lamp_styles                  
                      template: light-color
                    #----------------------------------------------------------------
                    ## Left Track
                    #----------------------------------------------------------------                
                    - type: 'custom:button-card'
                      entity: light.left_track
                      name: Left
                      custom_fields:
                        icon_spot: *icon_spot
                      styles: *icon_spot_styles               
                      template: light-color
                    #----------------------------------------------------------------
                    ## Center Track
                    #----------------------------------------------------------------                
                    - type: 'custom:button-card'
                      entity: light.center_track
                      name: Center
                      custom_fields:
                        icon_spot: *icon_spot
                      styles: *icon_spot_styles          
                      template: light-color
                    #----------------------------------------------------------------
                    ## Right Track
                    #----------------------------------------------------------------    
                    - type: 'custom:button-card'
                      entity: light.right_track
                      name: Right
                      custom_fields:
                        icon_spot: *icon_spot
                      styles: *icon_spot_styles         
                      template: light-color
                    #----------------------------------------------------------------
                    ## Heater
                    #----------------------------------------------------------------                    
                    - type: 'custom:button-card'
                      entity: switch.switchbot
                      icon: 'hass:fan'
                      style:
                        top: 37.9%
                        left: 80.05%
                        width: 10%
                      custom_fields:
                        icon_fan: >
                          [[[ const boolean = states[entity.entity_id.replace(entity.entity_id.split('.')[0], 'input_boolean')].state;
                          const style = '<svg viewBox="0 0 50 50"> <style>@keyframes rotate{0%{visibility:visible;transform:rotate(0deg)}100%{transform:rotate(1080deg)}}.start{animation:rotate 2.8s ease-in;transform-origin:center;fill:#5daeea;visibility:hidden}.on_delay{animation:rotate 1.8s linear infinite;transform-origin:center;fill:#5daeea;animation-delay:2.8s;visibility:hidden}.on{animation:rotate 1.8s linear infinite;transform-origin:center;fill:#5daeea;visibility:hidden}.end{animation:rotate 2.8s;transform-origin:center;fill:#9ca2a5;animation-timing-function:cubic-bezier(.61,1,.88,1)}</style>';
                          const path = '<circle cx="25" cy="25" r="6.6"/> <path d="M31.9 30.4c-.5.6-1.1 1.1-1.7 1.5-1.4 1.1-3.2 1.7-5.2 1.7-2.3 0-4.5-.9-6-2.4-.9 1.1-1.6 2.3-2.3 3.2l-4.9 5.4c-1.8 2.7.3 5.6 2.5 7 3.9 2.4 9.8 3.1 14.1 1.9 4.6-1.3 7.9-4.7 7.4-9.7-.2-3.4-1.9-6-3.9-8.6zM17 28.3c-.4-1-.6-2.1-.6-3.3a8.7 8.7 0 0 1 6.4-8.4l-1.6-3.5L19 6.2c-1.5-2.8-5-2.5-7.3-1.2-4 2.2-7.5 6.9-8.7 11.3-1.2 4.6.2 9.2 4.7 11.3 3.1 1.3 6.1 1.2 9.3.7zm26.9-17.6c-3.3-3.4-8-4.6-12.1-1.8-2.8 1.8-4.2 4.6-5.5 7.5 4.2.6 7.4 4.2 7.4 8.6 0 .9-.1 1.7-.4 2.5 1.3.2 2.8.3 3.8.4 2.3.4 4.7 1.3 7.1 1.7 3.2.3 4.7-3 4.8-5.6.3-4.6-1.9-10.1-5.1-13.3z"/>';
                          if (entity.state === 'off' && boolean === 'off') { return `${style}<g class="end">${path}</g></svg>`; }
                          if (entity.state === 'on' && boolean === 'off') { return `${style}<g class="start">${path}</g><g class="on_delay">${path}</g></svg>`; }
                          if (entity.state === 'on' && boolean === 'on') { return `${style}<g class="on">${path}</g></svg>`; }
                          else if (entity.state==='off' && boolean==='on') { return `${style}<g fill="#9ca2a5">${path}</g></svg>`; } ]]]
                        circle: >
                          [[[ if (entity.state === 'on') {
                          var select_state = states['input_select.sovrum_anslut_speed'].state;
                          var select_percent;
                          if (select_state == 'Tyst') { select_percent = "33"; }
                          else if (select_state == 'Medium') { select_percent = "66"; }
                          else if (select_state == 'Max') { select_percent = "100"; }
                          const speed = select_percent;
                          const radius = 20.5; const circumference = radius * 2 * Math.PI;
                          return `<svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="${radius}" stroke="#b2b2b2" stroke-width="1.5" fill="none" style="
                          transform: rotate(-90deg); transform-origin: 50% 50%; stroke-dasharray: ${circumference}; stroke-dashoffset: ${circumference - speed / 100 * circumference};" />
                          <text x="50%" y="54%" fill="#8d8e90" font-size="14" text-anchor="middle" alignment-baseline="middle">${speed}<tspan font-size="10">%</tspan></text></svg>`; } ]]]
                      styles:
                        custom_fields:
                          icon_fan:
                            [top: 9%, left: 10%, width: 3vw, position: absolute]
                          circle:
                            [display: "[[[ return states[entity.entity_id.replace(entity.entity_id.split('.')[0], 'input_boolean')].state === 'on' ? 'none' : 'initial'; ]]]"]
                      template: ['base', 'loader']
                    #----------------------------------------------------------------
                    ## Shield
                    #----------------------------------------------------------------                    
                    - type: 'custom:button-card'
                      icon: 'hass:television-classic'
                      name: TV
                      aspect_ratio: 1/1
                      style: |
                        ha-card:hover {
                          transform: scale(1.05);
                          box-shadow: 0 0 10px;
                          }
                      styles:
                        state:
                          - color: 'rgba(255,255,255,1)'
                          - font-size: 20px
                        card:
                          - border-radius: 30px
                          - font-family: DM Sans
                          - background: 'rgba(255,255,255,.1'
                      tap_action:
                        action: toggle
                      entity: media_player.shield_tv
                      show_state: true
                      state:
                        - value: playing
                          styles:
                            card:
                              - background: 'rgba(255,255,255,.8)'
                              - border: 1px solid white
                              - box-shadow: '0 0 10px, inset 0 0 5px'
                            state:
                              - animation: blink 2s ease infinite
                              - color: 'rgb(100,100,255)'
                            icon:
                              - color: 'rgb(100,100,255)'
                            name:
                              - color: 'rgba(0,0,0,.6)'
                              - font-weight: bold
              #################################################################
              ## Kitchen Controls
              #################################################################
              Kitchen:
                type: 'custom:mod-card'
                style: |
                  ha-card {
                    background: rgba(0,0,0,.3);
                    padding: 10px;
                    border-radius: 35px;
                    margin-top: none;
                    }
                card:
                  type: grid
                  columns: 3
                  cards:
                    #----------------------------------------------------------------
                    ## Kitchen Track
                    #----------------------------------------------------------------                
                    - type: 'custom:button-card'
                      entity: light.kitchen
                      name: Track
                      custom_fields:
                        icon_spot: *icon_spot
                      styles: *icon_spot_styles              
                      template: light-color
                    #----------------------------------------------------------------
                    ## Nanoleaf Dino Panesl
                    #----------------------------------------------------------------                    
                    - type: 'custom:button-card'
                      entity: light.dino_panel
                      custom_fields:
                          icon_dino: >
                            <svg viewBox="0 0 50 50">
                            <path fill="#fcd40a" d="M20 22H18V17H20M6 22H4V17H6M23 4V13A2 2 0 0 1 21 15H3A2 2 0 0 1 1 13V4A2 2 0 0 1 3 2H21A2 2 0 0 1 23 4M21 4H3V13H21M20 6H15V8H20M18 9H15V11H18M14 11H4L6.73 7.36L8.73 10.09L9.46 9.55L8.2 7.82L9.91 5.55Z"/>
                            <path class="${state}" fill="F426FF" d="M20 22H18V17H20M6 22H4V17H6M23 4V13A2 2 0 0 1 21 15H3A2 2 0 0 1 1 13V4A2 2 0 0 1 3 2H21A2 2 0 0 1 23 4M21 4H3V13H21M20 6H15V8H20M18 9H15V11H18M14 11H4L6.73 7.36L8.73 10.09L9.46 9.55L8.2 7.82L9.91 5.55Z"/> </svg>`
                      styles:
                        custom_fields:
                          icon_dino:
                            [top: 11%, left: 6%, width: 5.25em, position: absolute]                  
                      template: light-color    
                    #----------------------------------------------------------------
                    ## Kettle
                    #----------------------------------------------------------------                          
                    - type: 'custom:button-card'
                      aspect_ratio: 1/1
                      tap_action:
                        action: toggle
                      entity: switch.kettle
                      name: Kettle
                      style: |
                        ha-card:hover {
                          transform: scale(1.05);
                          box-shadow: 0 0 10px;
                          }
                      styles:
                        name:
                          - padding: 8px 1em
                          - font-family: Roboto
                          - font-size: 20px
                        card:
                          - border-radius: 30px
                          - background: 'rgba(255,255,255,.1)'
                      state:
                        - value: 'on'
                          styles:
                            card:
                              - background: 'rgba(255,255,255,.8)'
                              - border: 1px solid white
                              - box-shadow: '0 0 10px, inset 0 0 5px'
                            name:
                              - font-weight: bold
                              - color: 'rgba(0,0,0,.6)'
                            icon:
                              - color: 'rgb(255, 122, 0)'
                      hold_action:
                        action: more-info
  - title: Winston
    path: winston
    icon: 'mdi:robot-vacuum-variant'
    panel: false
    badges: []
    cards:
      - type: 'custom:vertical-stack-in-card'
        cards:
          - type: 'custom:vacuum-card'
            entity: vacuum.winston
            stats:
              default:
                - attribute: filter_left
                  unit: hours
                  subtitle: Filter
                - attribute: side_brush_left
                  unit: hours
                  subtitle: Side bish
                - attribute: main_brush_left
                  unit: hours
                  subtitle: Main bish
                - attribute: sensor_dirty_left
                  unit: hours
                  subtitle: Sensors
              cleaning:
                - attribute: cleaned_area
                  unit: m2
                  subtitle: Cleaning area
                - attribute: cleaning_time
                  unit: minutes
                  subtitle: Cleaning time
            actions:
              - name: Clean hallway
                service: script.clean_hallway
                icon: 'mdi:door'
              - name: Clean guest bathroom
                service: script.clean_bathroom
                icon: 'mdi:shower'
              - name: Clean office
                service: script.clean_office
                icon: 'mdi:desk'
              - name: Clean living room
                service: script.clean_living_room
                icon: 'mdi:sofa'
              - name: Clean kitchen
                service: script.clean_kitchen
                icon: 'mdi:silverware-fork-knife'
          - type: 'custom:xiaomi-vacuum-map-card'
            entity: vacuum.winston
            map_camera: camera.xiaomi_cloud_map_extractor
            camera_calibration: enable
            zones:
              - - - 26710
                  - 22064
                  - 32110
                  - 23314
                  - 1
                - - 27265
                  - 20396
                  - 32115
                  - 22096
                  - 1
              - - - 26644
                  - 23295
                  - 32094
                  - 26045
                  - 1
              - - - 23464
                  - 20509
                  - 26664
                  - 24009
                  - 1
                - - 26606
                  - 20742
                  - 27206
                  - 21942
                  - 1
              - - - 20984
                  - 23974
                  - 26934
                  - 26024
                  - 1
              - - - 21143
                  - 21284
                  - 23293
                  - 23984
                  - 1
            rooms:
              - all
  - title: Home Theater
    path: home-theater
    icon: 'mdi:theater'
    panel: false
    badges: []
    cards:
      - type: 'custom:vertical-stack-in-card'
        cards:
          - type: picture-elements
            image: /local/img/LHarmonyBG.jpg
            elements:
              - type: image
                image: /local/icons/media_icons/power.svg
                entity: script.toggle_power
                tap_action:
                  action: toggle
                show_state: null
                style:
                  top: 10em
                  left: 10%
                  width: 54px
                  height: 54px
                  background-color: 'rgb(255, 255, 255, 0.0)'
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 2
              - type: image
                image: /local/icons/media_icons/netflix.svg
                entity: script.launch_netflix
                tap_action:
                  action: toggle
                style:
                  top: 10em
                  left: 25%
                  width: 54px
                  height: 54px
                  background-color: 'rgb(255, 255, 255, 0.0)'
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 2
              - type: image
                image: /local/icons/media_icons/hulu.svg
                entity: script.launch_netflix
                tap_action:
                  action: toggle
                style:
                  top: 10em
                  left: 40%
                  width: 54px
                  height: 54px
                  background-color: 'rgb(255, 255, 255, 0.0)'
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 2
              - type: image
                image: /local/icons/media_icons/remote.svg
                entity: script.remote_finder
                tap_action:
                  action: toggle
                style:
                  top: 10em
                  left: 55%
                  width: 54px
                  height: 54px
                  background-color: 'rgb(255, 255, 255, 0.0)'
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 2
              - type: image
                image: /local/icons/media_icons/chevron-up.svg
                entity: script.nav_up
                tap_action:
                  action: toggle
                style:
                  top: 4em
                  left: 80%
                  width: 54px
                  height: 54px
                  background-color: 'rgb(255, 255, 255, 0.0)'
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 2
              - type: image
                image: /local/icons/media_icons/circle-empty.svg
                entity: script.nav_enter
                tap_action:
                  action: toggle
                style:
                  top: 8em
                  left: 80%
                  width: 70px
                  height: 70px
                  background-color: 'rgb(255, 255, 255, 0.0)'
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 2
              - type: image
                image: /local/icons/media_icons/chevron-down.svg
                entity: script.nav_down
                tap_action:
                  action: toggle
                style:
                  top: 12em
                  left: 80%
                  width: 54px
                  height: 54px
                  background-color: 'rgb(255, 255, 255, 0.0)'
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 2
              - type: image
                image: /local/icons/media_icons/chevron-left.svg
                entity: script.nav_left
                tap_action:
                  action: toggle
                style:
                  top: 8em
                  left: 68%
                  width: 54px
                  height: 54px
                  background-color: 'rgb(255, 255, 255, 0.0)'
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 2
              - type: image
                image: /local/icons/media_icons/chevron-right.svg
                entity: script.nav_right
                tap_action:
                  action: toggle
                style:
                  top: 8em
                  left: 92%
                  width: 54px
                  height: 54px
                  background-color: 'rgb(255, 255, 255, 0.0)'
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 2
              - type: image
                image: /local/icons/media_icons/home.svg
                entity: script.nav_home
                tap_action:
                  action: toggle
                style:
                  top: 16em
                  left: 88%
                  width: 35px
                  height: 35px
                  background-color: 'rgb(255, 255, 255, 0.0)'
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 2
              - type: image
                image: /local/icons/media_icons/back.svg
                entity: script.nav_back
                tap_action:
                  action: toggle
                style:
                  top: 16em
                  left: 72%
                  width: 35px
                  height: 35px
                  background-color: 'rgb(255, 255, 255, 0.0)'
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 2
              - type: image
                image: /local/icons/media_icons/horizontal_Rule.png
                style:
                  top: 13em
                  left: 35%
                  width: 60%
                  height: 2px
                  filter: invert(0.20)
                  border-radius: 4px
      - type: 'custom:vertical-stack-in-card'
        cards:
          - type: picture-elements
            image: /local/img/denon_card.png
            elements:
              - type: image
                image: /local/icons/media_icons/surround-sound.svg
                entity: script.sound_mode_auto
                tap_action:
                  action: toggle
                style:
                  top: 10em
                  left: 11%
                  width: 54px
                  height: 54px
                  background-color: 'rgb(255, 255, 255, 0.0)'
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 2
              - type: image
                image: /local/icons/media_icons/stereo.svg
                entity: script.sound_mode_stereo
                tap_action:
                  action: toggle
                style:
                  top: 10em
                  left: 25%
                  width: 54px
                  height: 54px
                  background-color: 'rgb(255, 255, 255, 0.0)'
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 2
              - type: image
                image: /local/icons/media_icons/eco.svg
                entity: switch.eco
                tap_action:
                  action: toggle
                style:
                  top: 10em
                  left: 40%
                  width: 54px
                  height: 54px
                  background-color: 'rgb(255, 255, 255, 0.0)'
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 2
              - type: image
                image: /local/icons/media_icons/menu.svg
                entity: switch.denon_menu
                tap_action:
                  action: toggle
                style:
                  top: 10em
                  left: 55%
                  width: 54px
                  height: 54px
                  background-color: 'rgb(255, 255, 255, 0.0)'
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 2
              - type: image
                image: local/icons/media_icons/vol_-.png
                style:
                  top: 12em
                  left: 85%
                  width: 54px
                  height: 54px
                  background-color: 'rgb(255, 255, 255, 0.0)'
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 2
              - type: image
                image: local/icons/media_icons/vol_%2B.png
                tap_action: call-service
                service: script.volume_up
                style:
                  top: 8em
                  left: 85%
                  width: 54px
                  height: 54px
                  background-color: 'rgb(255, 255, 255, 0.0)'
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 2
              - type: image
                image: /local/icons/media_icons/volBorder.png
                style:
                  top: 11em
                  left: 85%
                  width: 69px
                  height: 155px
                  filter: invert(0.20)
                  border-radius: 4px
                  z-index: 1
              - type: image
                image: /local/icons/media_icons/horizontal_Rule.png
                style:
                  top: 13em
                  left: 35%
                  width: 60%
                  height: 2px
                  filter: invert(0.20)
          - type: entities
            entities:
              - input_number.denon_volume
  - title: Climate Control
    path: climate-control
    icon: 'mdi:home-thermometer-outline'
    badges:
      - entity: sensor.kirby_temperature
      - entity: sensor.kirby_humidity
    cards:
      - type: vertical-stack
        cards:
          - type: horizontal-stack
            cards:
              - type: 'custom:mini-graph-card'
                entities:
                  - sensor.kirby_temperature
                decimals: 1
                name: Upstairs Temp
                hours_to_show: 48
              - type: 'custom:mini-graph-card'
                entities:
                  - sensor.kirby_humidity
                decimals: 1
                name: Upstairs Humidity
                hours_to_show: 48
          - type: horizontal-stack
            cards:
              - type: 'custom:mini-graph-card'
                entities:
                  - sensor.temperature_living_room
                decimals: 1
                name: Downstairs Temp
                hours_to_show: 48
              - type: 'custom:mini-graph-card'
                entities:
                  - sensor.humidity_living_room
                decimals: 1
                name: Downstairs Humidity
                hours_to_show: 48
              - type: button
                tap_action:
                  action: toggle
                entity: switch.switchbot
                icon: 'mdi:radiator'
                show_name: false
                show_state: false
          - type: sensor
            graph: line
            detail: 2
            entity: sensor.temperature_media
            hours_to_show: 48
      - type: 'custom:purifier-card'
        entity: fan.kirby
        show_toolbar: true
        attribute: dyson_speed
  - title: ha
    path: ha
    icon: 'mdi:home-assistant'
    badges: []
    cards:
      - type: vertical-stack
        cards:
          - type: glance
            entities:
              - entity: sensor.time_online
                name: Uptime
              - entity: sensor.latest_version
              - entity: binary_sensor.updater
              - entity: sensor.hacs
            title: Home Assistant
            state_color: false
          - type: horizontal-stack
            cards:
              - type: 'custom:mini-graph-card'
                entities:
                  - sensor.processor_use_percent
                show: null
                color_thresholds:
                  - value: 25
                    color: '#6aa84f'
                  - value: 50
                    color: '#f1c232'
                  - value: 75
                    color: '#e69138'
                  - value: 100
                    color: '#cc0000'
                line_width: 8
                font_size: 75
              - type: 'custom:mini-graph-card'
                entities:
                  - sensor.memory_use_percent
                show: null
                color_thresholds:
                  - value: 25
                    color: '#6aa84f'
                  - value: 50
                    color: '#f1c232'
                  - value: 75
                    color: '#e69138'
                  - value: 100
                    color: '#cc0000'
                line_width: 8
                font_size: 75
              - type: 'custom:mini-graph-card'
                entities:
                  - sensor.processor_temperature
                show: null
                color_thresholds:
                  - value: 122
                    color: '#6aa84f'
                  - value: 140
                    color: '#f1c232'
                  - value: 176
                    color: '#e69138'
                  - value: 200
                    color: '#cc0000'
                line_width: 8
                font_size: 75
          - type: horizontal-stack
            cards:
              - type: glance
                entities:
                  - entity: sensor.count_automations
                  - entity: sensor.count_binary_sensors
                  - entity: sensor.count_device_trackers
                  - entity: sensor.count_scripts
                  - entity: sensor.count_sensors
                  - entity: sensor.count_switches
                columns: 3
                show_icon: false
          - type: glance
            entities:
              - entity: zone.home
                icon: 'mdi:home-assistant'
                name: Hassio
                tap_action:
                  action: call-service
                  service: homeassistant.restart
              - entity: zone.home
                icon: 'mdi:cogs'
                name: Automation
                tap_action:
                  action: call-service
                  service: automation.reload
              - entity: zone.home
                icon: 'mdi:script-text'
                name: Script
                tap_action:
                  action: call-service
                  service: script.reload
              - entity: zone.home
                icon: 'mdi:food-apple'
                name: Core
                tap_action:
                  action: call-service
                  service: homeassistant.reload_core_config
            title: Restart Services
            show_state: false
      - type: vertical-stack
        cards:
          - type: glance
            entities:
              - entity: zone.home
                icon: 'mdi:speedometer'
                name: Speed Test
                tap_action:
                  action: call-service
                  service: speedtestdotnet.speedtest
            title: Network
            show_state: false
          - type: horizontal-stack
            cards:
              - type: 'custom:mini-graph-card'
                entities:
                  - sensor.speedtest_download
                decimals: 0
                color_thresholds:
                  - value: 1000
                    color: '#6aa84f'
                  - value: 800
                    color: '#93c47d'
                  - value: 650
                    color: '#b6d7a8'
                  - value: 500
                    color: '#f1c232'
                  - value: 350
                    color: '#e69138'
                  - value: 150
                    color: '#cc0000'
              - type: 'custom:mini-graph-card'
                entities:
                  - sensor.speedtest_upload
                decimals: 0
                color_thresholds:
                  - value: 1000
                    color: '#6aa84f'
                  - value: 800
                    color: '#93c47d'
                  - value: 650
                    color: '#b6d7a8'
                  - value: 500
                    color: '#f1c232'
                  - value: 350
                    color: '#e69138'
                  - value: 150
                    color: '#cc0000'
          - type: sensor
            graph: line
            detail: 2
            entity: sensor.temperature_media