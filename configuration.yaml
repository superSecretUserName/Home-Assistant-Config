#################################################################
## Home Assistant - Core Configuration
#################################################################

# Configure a default setup of Home Assistant (frontend, api, etc)
default_config:

#################################################################
## Components
#################################################################

# Logger
logger:
  default: info
  logs:
    # Error fetching ipp data
    homeassistant.components.ipp: critical
    # Setup of media_player platform androidtv is taking over 10 seconds. 
    homeassistant.components.media_player: error
    # Config entry for ipp not ready yet 
    homeassistant.config_entries: critical
    # Update of camera.xiaomi_cloud_map_extractor is taking over 10 seconds 
    homeassistant.helpers.entity: error
    # Custom integration for xiaomi_cloud_map_extractor 
    homeassistant.loader: error

# Recorder
recorder:
  auto_purge: true
  purge_keep_days: 5
  commit_interval: 1
  include:
    entities:
      - device_tracker.keys
      - device_tracker.pixel_3
      - sensor.humidity_living_room
      - sensor.humidity_media      
      - sensor.memory_use_percent
      - sensor.pressure_living_room        
      - sensor.pressure_media
      - sensor.speedtest_download
      - sensor.speedtest_upload  
      - sensor.temperature_living_room   
      - sensor.temperature_media
      - sensor.time_online    
    entity_globs:
      - person.jeffrey_*
      - person.tiffany_*      
      - sensor.kirby_*
      - sensor.mail_*
      - sensor.processor_*    

# Text to speech
tts:
  - platform: google_translate
  
input_boolean:
  shield_tv:
    initial: off
#################################################################
## Theme
#################################################################

frontend:
  themes: !include_dir_merge_named themes

lovelace:
  mode: yaml
  resources:
    [ {url: /hacsfiles/button-card/button-card.js,                                  type: module},
      {url: /hacsfiles/custom-sidebar/custom-sidebar.js,                            type: module},
      {url: /hacsfiles/light-popup-card/light-popup-card.js,                        type: module},
      {url: /hacsfiles/lovelace-card-mod/card-mod.js,                               type: module},
      {url: /hacsfiles/lovelace-fold-entity-row/fold-entity-row.js,                 type: module},
      {url: /hacsfiles/lovelace-hui-element/hui-element.js,                         type: module},
      {url: /hacsfiles/lovelace-paper-buttons-row/paper-buttons-row.js,             type: module},
      {url: /hacsfiles/lovelace-slider-entity-row/slider-entity-row.js,             type: module},
      {url: /hacsfiles/lovelace-state-switch/state-switch.js,                       type: module},
      {url: /hacsfiles/lovelace-swipe-navigation/swipe-navigation.js,               type: module},       
      {url: /hacsfiles/lovelace-tempometer-gauge-card/tempometer-gauge-card.js,     type: module},
      {url: /hacsfiles/lovelace-xiaomi-vacuum-map-card/xiaomi-vacuum-map-card.js,   type: module},
      {url: /hacsfiles/mini-graph-card/mini-graph-card-bundle.js,                   type: module},
      {url: /hacsfiles/purifier-card/purifier-card.js,                              type: module},
      {url: /hacsfiles/rgb-light-card/card.js,                                      type: module},
      {url: /hacsfiles/stack-in-card/stack-in-card.js,                              type: module},  
      {url: /hacsfiles/vacuum-card/vacuum-card.js,                                  type: module},
      {url: /hacsfiles/vertical-stack-in-card/vertical-stack-in-card.js,            type: module}, ]                          
#################################################################
## Add-ons
################################################################# 

browser_mod:
  prefix: 'browser_mod_'

#################################################################
## Software Integrations
#################################################################

# Google Cal
# google:
#   client_id: !secret google_client_id
#   client_secret: !secret google_client_secret

# Speedtest
speedtestdotnet:
  scan_interval:
    hours: 2

#################################################################
## Device Integrations
#################################################################

# Dyson
dyson:
  username: !secret dyson_username
  password: !secret dyson_password
  language: US
  devices:
    - device_id: !secret kirby_device_id
      device_ip: !secret kirby_device_ip

# Winston
vacuum:
  - platform: xiaomi_miio
    host: !secret winston_host
    token: !secret winston_token
    name: Winston

#################################################################
## Camera Integrations
#################################################################

camera:
# Winston lidar
  - platform: xiaomi_cloud_map_extractor
    host: !secret winston_host
    token: !secret winston_token
    username: !secret winston_username
    password: !secret winston_password
    country: us
    colors:
      color_map_outside: [3, 169, 244]
    room_colors: 
      # Hallway
      16: [253, 211, 82]
      # Living Room
      17: [106, 191, 209]
      # Kitchen
      18: [145, 200, 255]
      # Office
      19: [245, 142, 110]
      # Bathroom
      20: [7, 152, 183]
    draw: ["all"]
    map_transformation:
      scale: 2
      trim:
        top: 22
        bottom: 22
        left: 22
        right: 22
    attributes:
      - calibration_points
      - charger
      - goto
      - goto_path
      - goto_predicted_path
      - image
      - is_empty
      - map_name
      - no_go_areas
      - no_mopping_areas
      - obstacles
      - path
      - room_numbers
      - rooms
      - vacuum_position
      - vacuum_room
      - walls
      - zones
    scan_interval:
      seconds: 10
    auto_update: true

#################################################################
## Media Players
#################################################################

climate:
  - platform: generic_thermostat
    name: Living Room
    heater: switch.switchbot
    target_sensor: sensor.temperature_living_room

#################################################################
## Media Players
#################################################################

media_player:
# Shield
  - platform: androidtv
    name: SHIELD TV
    host: !secret shield_ip
# Sonny
  - platform: androidtv
    name: Sonny TV
    host: !secret sonny_ip

#################################################################
## Sensors
#################################################################

binary_sensor:
# Workday
  - platform: workday
    country: US
    workdays: [mon, tue, wed, thu, fri]
    excludes: [sat, sun]

######## INCLUDES ########
homeassistant:
  packages: !include_dir_named integrations